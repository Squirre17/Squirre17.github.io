{
    "version": "https://jsonfeed.org/version/1",
    "title": "Squirre17 Blog • All posts by \"ghidra\" tag",
    "description": "萌豚即是正义",
    "home_page_url": "https://Squirre17.github.io",
    "items": [
        {
            "id": "https://squirre17.github.io/2022/10/26/Ghidra-INDIRECT-explanation/",
            "url": "https://squirre17.github.io/2022/10/26/Ghidra-INDIRECT-explanation/",
            "title": "Ghidra-INDIRECT-explanation",
            "date_published": "2022-10-26T10:05:02.000Z",
            "content_html": "<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\">undefined4 <span class=\"title function_\">FUN_000114b8</span><span class=\"params\">(<span class=\"type\">void</span>)</span></span><br><span class=\"line\"></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">  undefined4 in_r3;</span><br><span class=\"line\">  </span><br><span class=\"line\">  <span class=\"built_in\">printf</span>(<span class=\"string\">&quot;%s(%d)\\n&quot;</span>,<span class=\"string\">&quot;part_data_end&quot;</span>,<span class=\"number\">0x7d</span>,in_r3,in_r3);</span><br><span class=\"line\">  <span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>output result as following (pcode-refined)</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">(ram, 0x114d4, 4) INDIRECT (ram, 0x114d4, 4) , (const, 0x15, 4)</span><br><span class=\"line\">(ram, 0x114d8, 4) INDIRECT (ram, 0x114d8, 4) , (const, 0x15, 4)</span><br><span class=\"line\"> ---  CALL (ram, 0x10ba4, 8) , (ram, 0x114d8, 4) , (ram, 0x114d4, 4) , (const, 0x7d, 4) , (register, 0x2c, 4) , (register, 0x2c, 4)</span><br><span class=\"line\"></span><br><span class=\"line\">(register, 0x20, 4) COPY (const, 0x0, 4)</span><br><span class=\"line\">(ram, 0x114d4, 4) COPY (ram, 0x114d4, 4)</span><br><span class=\"line\">(ram, 0x114d8, 4) COPY (ram, 0x114d8, 4)</span><br><span class=\"line\"></span><br><span class=\"line\"> ---  RETURN (const, 0x0, 4) , (register, 0x20, 4)</span><br></pre></td></tr></table></figure>\n<p>M4rsuri’s explanation(<a href=\"https://github.com/NationalSecurityAgency/ghidra/issues/2744\">INDIRECT pcode op, input1 misunderstood · Issue #2744 · NationalSecurityAgency/ghidra · GitHub</a>)</p>\n<pre><code>I think that INDIRECT just indicates the varnode in output can be affected by the pcode indicated by it's input1.So it's impossible for a varnode to be affected when it's both not the output of an instruction and it's not associated with the instruction through an INDIRECT.\nIn other words, the varnodes being the output of all INDIRECTs associated with an instruction is the over-approximation of all varnodes that may be affected by the execution of this instruction. Only CALL/CALLIND instructions can have side affects because we need to take the execution of their corresponding subroutines into consideration. So INDIRECT instructions only appear before CALL/CALLIND instructions.\nI wonder if my understanding is proper.\nThank you.\n</code></pre>\n<p>INDIRECT pass input0 to output, but output be affected by some pcode indicated by input1 possibly.<br>\nAffect means “be changed” and so on in a narrow sense.<br>\nbecause we don’t know what the subroutine indicated by subsequent CALL pcode that take out our parameter’s address will do Isn’t it? Maybe it can modify the content in the corresponding address. So it’s value is indirected when machine is executed to the next COPY pcode and pass it to other varnode.(so INDIRECT meaning - varnode passes through other subroutine before reaching its destination)<br>\n <code>A special address space indicates input1's use as an internal reference encoding</code>  simply means the Seqnum which indicate the sequence number of anyone pcode.</p>\n<p>if U print out above CALL pcode’s seqnum, u will find it exactly is  <code>0x15</code>  (const, 0x15, 4).</p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">(ram, <span class=\"number\">0x114c8</span>, <span class=\"number\">67</span>, <span class=\"number\">0</span>)</span><br><span class=\"line\">(ram, <span class=\"number\">0x114d4</span>, <span class=\"number\">4</span>) INDIRECT (ram, <span class=\"number\">0x114d4</span>, <span class=\"number\">4</span>) , (<span class=\"type\">const</span>, <span class=\"number\">0x15</span>, <span class=\"number\">4</span>)</span><br><span class=\"line\">(ram, <span class=\"number\">0x114c8</span>, <span class=\"number\">69</span>, <span class=\"number\">1</span>)</span><br><span class=\"line\">(ram, <span class=\"number\">0x114d8</span>, <span class=\"number\">4</span>) INDIRECT (ram, <span class=\"number\">0x114d8</span>, <span class=\"number\">4</span>) , (<span class=\"type\">const</span>, <span class=\"number\">0x15</span>, <span class=\"number\">4</span>)</span><br><span class=\"line\">(ram, <span class=\"number\">0x114c8</span>, <span class=\"number\">21</span>, <span class=\"number\">2</span>)                                             &lt;&lt;- <span class=\"number\">21</span> = <span class=\"number\">0x15</span></span><br><span class=\"line\"> ---  CALL (ram, <span class=\"number\">0x10ba4</span>, <span class=\"number\">8</span>) , (ram, <span class=\"number\">0x114d8</span>, <span class=\"number\">4</span>) , (ram, <span class=\"number\">0x114d4</span>, <span class=\"number\">4</span>) , (<span class=\"type\">const</span>, <span class=\"number\">0x7d</span>, <span class=\"number\">4</span>) , (<span class=\"keyword\">register</span>, <span class=\"number\">0x2c</span>, <span class=\"number\">4</span>) , (<span class=\"keyword\">register</span>, <span class=\"number\">0x2c</span>, <span class=\"number\">4</span>)</span><br><span class=\"line\">(ram, <span class=\"number\">0x114cc</span>, <span class=\"number\">29</span>, <span class=\"number\">3</span>) </span><br><span class=\"line\">(<span class=\"keyword\">register</span>, <span class=\"number\">0x20</span>, <span class=\"number\">4</span>) COPY (<span class=\"type\">const</span>, <span class=\"number\">0x0</span>, <span class=\"number\">4</span>)</span><br><span class=\"line\">(ram, <span class=\"number\">0x114d0</span>, <span class=\"number\">68</span>, <span class=\"number\">4</span>)</span><br><span class=\"line\">(ram, <span class=\"number\">0x114d4</span>, <span class=\"number\">4</span>) COPY (ram, <span class=\"number\">0x114d4</span>, <span class=\"number\">4</span>)</span><br><span class=\"line\">(ram, <span class=\"number\">0x114d0</span>, <span class=\"number\">70</span>, <span class=\"number\">5</span>)</span><br><span class=\"line\">(ram, <span class=\"number\">0x114d8</span>, <span class=\"number\">4</span>) COPY (ram, <span class=\"number\">0x114d8</span>, <span class=\"number\">4</span>)</span><br><span class=\"line\">(ram, <span class=\"number\">0x114d0</span>, <span class=\"number\">44</span>, <span class=\"number\">6</span>)</span><br><span class=\"line\"> ---  RETURN (<span class=\"type\">const</span>, <span class=\"number\">0x0</span>, <span class=\"number\">4</span>) , (<span class=\"keyword\">register</span>, <span class=\"number\">0x20</span>, <span class=\"number\">4</span>)</span><br></pre></td></tr></table></figure>\n<p>Thanks M4tsuri for his help.</p>\n",
            "tags": [
                "Ghidra"
            ]
        }
    ]
}